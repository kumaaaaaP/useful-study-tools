<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鉄壁単語リスト - 通し番号維持版</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            line-height: 1.6;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        h1 {
            text-align: center;
            color: #1a1a1a;
            margin-bottom: 25px;
        }
        .search-container {
            position: sticky;
            top: 0;
            background: #fff;
            padding: 10px 0 20px 0;
            z-index: 100;
        }
        .search-box {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            box-sizing: border-box;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .search-box:focus {
            border-color: #007bff;
            box-shadow: 0 0 8px rgba(0,123,255,0.2);
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }
        th {
            background-color: #f8f9fa;
            color: #555;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 14px;
        }
        .num-col { width: 80px; color: #888; font-family: monospace; }
        .eng-col { width: 30%; font-weight: bold; color: #007bff; font-size: 1.1em; }
        .jp-col { width: auto; color: #333; }
        
        tr:hover { background-color: #f8fbff; }
        
        .no-result {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.1em;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>鉄壁 単語リスト</h1>
    
    <div class="search-container">
        <input type="text" id="searchInput" class="search-box" placeholder="英単語または日本語で検索（例: vital, 重要）...">
    </div>

    <table id="wordTable">
        <thead>
            <tr>
                <th class="num-col">No.</th>
                <th class="eng-col">英単語</th>
                <th class="jp-col">日本語訳</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            </tbody>
    </table>
    <div id="noResult" class="no-result" style="display: none;">該当する単語が見つかりません。</div>
</div>

<script src="teppeki-script.js"></script>

<script>
    const tableBody = document.getElementById('tableBody');
    const searchInput = document.getElementById('searchInput');
    const noResult = document.getElementById('noResult');

    /**
     * テーブルを描画する関数
     * @param {Array} wordsItems 表示する要素（オブジェクトに元のindexを含める）
     */
    function renderTable(wordsItems) {
        tableBody.innerHTML = '';
        
        if (wordsItems.length === 0) {
            noResult.style.display = 'block';
            return;
        }
        noResult.style.display = 'none';

        const fragment = document.createDocumentFragment();

        wordsItems.forEach(item => {
            const row = document.createElement('tr');
            
            // 通し番号（元の配列のインデックス + 1）
            const cellNum = document.createElement('td');
            cellNum.className = 'num-col';
            cellNum.textContent = item.originalIndex + 1;

            const cellEng = document.createElement('td');
            cellEng.className = 'eng-col';
            cellEng.textContent = item.english;

            const cellJp = document.createElement('td');
            cellJp.className = 'jp-col';
            cellJp.textContent = item.japanese;

            row.appendChild(cellNum);
            row.appendChild(cellEng);
            row.appendChild(cellJp);
            fragment.appendChild(row);
        });

        tableBody.appendChild(fragment);
    }

    // 検索・フィルタリング処理
    function handleSearch() {
        const keyword = searchInput.value.toLowerCase().trim();
        
        // 元の配列 allWords に、それぞれの元のインデックスを付与してフィルタリング
        const filtered = allWords
            .map((word, index) => ({ ...word, originalIndex: index }))
            .filter(word => {
                return word.english.toLowerCase().includes(keyword) || 
                       word.japanese.includes(keyword);
            });

        renderTable(filtered);
    }

    // 初期化
    window.addEventListener('DOMContentLoaded', () => {
        if (typeof allWords !== 'undefined') {
            // 初回は全件表示
            handleSearch();
        } else {
            tableBody.innerHTML = '<tr><td colspan="3" class="no-result">teppeki.jsの読み込みに失敗しました。</td></tr>';
        }
    });

    // 入力イベント
    searchInput.addEventListener('input', handleSearch);
</script>

</body>
</html>
